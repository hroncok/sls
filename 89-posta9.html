<meta http-equiv="content-type" content="text/html;charset=utf-8" />


<h1>Správa linuxového serveru: Webová rozhraní k poště (Squirrelmail a Roundcube)</h1>

<p>Tento díl je věnován možnostem a konfiguraci webových rozhraní pro přístup k poštovní schránce, konkrétně pak Squirrelmailu a Roundcube.</p>

<p>V <a href="http://www.linuxexpres.cz/praxe/sprava-linuxoveho-serveru-uzivatel-a-postovni-schranka">minulém díle</a> byly představeny možnosti klientského přístupu k poště. V dnešní době jsou k dispozici dvě možnosti. Jednou z nich je přístup přes poštovního klienta pomocí protokolů IMAP či POP3 a SMTP. Druhou je pak přístup přes webovou aplikaci. Běžní uživatelé jsou v dnešní době spíše zvyklí používat webové rozhraní než poštovního klienta (nemusí se nic nastavovat a k poště lze přistupovat z libovolného počítače).</p>
<p>V tomto díle budou představena dvě webová rozhraní, jednodušší Squirrelmail a komplexní Roundcube. Krátký popis i snímky obrazovky jsou u každého z nich.</p>
<h4>Bezpečnostní doporučení: používejte HTTPS</h4>
<p>Ať už si vyberete jakékoliv webové rozhraní, nelze než důrazně doporučit celé rozhraní provozovat pouze přes HTTPS, aby nedocházelo k odesílání jména a hesla přes nešifrované HTTP spojení.</p>
<h4>Bez IMAP serveru to nejde</h4>
<p>Obě webová rozhraní využívají pro přístup k poštovní schránce protokol IMAP, je tedy nutné mít IMAP server zprovozněný (návod, jak na to, naleznete v minulém díle). Nechcete-li nabízet přístup přes IMAP celému světu, nakonfigurujte IMAP server tak, aby naslouchal jen na localhostu. Pokud neomezujete odchozí SMTP pocházející přímo ze serveru (localhost), není třeba žádná speciální konfigurace pro odesílání pošty.</p>
<h3>Squirrelmail</h3>
<p>Squirrelmail je jednoduché webové rozhraní napsané v PHP bez pokročilých funkcí. Není to „Web 2.0“ aplikace, ale svou úlohu umí zastat velmi dobře. Podporuje dokonce i adresář s kontakty, jehož data jsou uchovávána v textových souborech. Squirrelmail si můžete prohlédnout na obrázcích níže:</p>
<p class="ph_center"><a href="http://www.linuxexpres.cz/uploads/gallery/original/6462.jpg" onclick="myPopImage('http://www.linuxexpres.cz/uploads/gallery/original/6462.jpg','Pohled na obsah schránky ve Squirrelmailu','922','770'); return false;"><img alt="Pohled na obsah schránky ve Squirrelmailu" class="ph_detail" height="372" src="http://www.linuxexpres.cz/uploads/gallery/detail/6462.jpg" width="446" /></a> <span class="ph_title">Pohled na obsah schránky ve Squirrelmailu</span></p>
<p class="ph_center"><a href="http://www.linuxexpres.cz/uploads/gallery/original/6463.jpg" onclick="myPopImage('http://www.linuxexpres.cz/uploads/gallery/original/6463.jpg','Psaní pošty ve Squirrelmailu','922','770'); return false;"><img alt="Psaní pošty ve Squirrelmailu" class="ph_detail" height="372" src="http://www.linuxexpres.cz/uploads/gallery/detail/6463.jpg" width="446" /></a> <span class="ph_title">Psaní pošty ve Squirrelmailu</span></p>
<p>Samotná instalace Squirrelmailu je velmi jednoduchá, stačí nainstalovat příslušný balíček:</p>
<pre>aptitude install squirrelmail</pre>
<p>Konfigurace vyžaduje ještě několik ručních zásahů. Asi je jasné, že aplikace zajišťující webové rozhraní k poště vyžaduje vhodné nastavení webového serveru. Konfigurační soubor nastavující službu na Apachi je k dispozici v <code>/etc/squirrelmail/apache.conf</code>. Je to vzorový soubor, takže si jej přizpůsobte. Pokud hostujete více virtuálních webů, je více než vhodné integrovat potřebné direktivy do příslušného virtuálního webu (ideálně do virtuálního webu chráněného SSL, viz výše). Pro to nejzákladnější nastavení, kdy je vytvořen alias <code>/squirrelmail</code> pro stávající konfiguraci, postačí vytvořit symbolický odkaz do <code>/etc/apache2/conf.d</code>, takto:</p>
<pre>ln -s /etc/squirrelmail/apache.conf /etc/apache2/conf.d/squirrelmail</pre>
<p>A restartovat webový server:</p>
<pre>service apache2 restart</pre>
<p>Nyní by již měl Squirrelmail fungovat. Pokud vám vadí angličtina a chtěli byste svým uživatelům poskytnout (převážně) české prostředí, upravte konfigurační soubor <code>/etc/squirrelmail/config_local.php</code> a přidejte do něj následující řádky se specifikací výchozího jazyka a znakové sady:</p>
<pre>$squirrelmail_default_language = 'cs_CZ';
$default_charset       = 'utf-8';</pre>
<p>Změna by měla být okamžitá, není třeba restartovat webový server. Kromě běžných funkcí nabízí Squirrelmail i několik pluginů, které jeho funkcionalitu rozšiřují. Jejich seznam získáte snadno, vypsáním balíčků obsahujících „squirrelmail“ v názvu:</p>
<pre>aptitude search squirrelmail</pre>
<p>Z těch zásadnějších doporučuji alespoň <code>squirrelmail-quicksave</code>, který nabízí, jak je z názvu patrné, automatické ukládání e-mailů po určité době.</p>
<h3>Roundcube</h3>
<p>Roundcube je oproti Squirrelmailu komplexnější, nabízí více funkcí a „Web 2.0“ rozhraní (tzn. AJAX), ovšem je také náročnější na zdroje – na rozdíl od Squirrelmailu, který si vystačí s textovými soubory, vyžaduje databázi (MySQL, PostgreSQL nebo SQLite). Názor si můžete udělat z obrázků níže:</p>
<p class="ph_center"><a href="http://www.linuxexpres.cz/uploads/gallery/original/6460.jpg" onclick="myPopImage('http://www.linuxexpres.cz/uploads/gallery/original/6460.jpg','Pohled na obsah schránky v Roundcube','1503','776'); return false;"><img alt="Pohled na obsah schránky v Roundcube" class="ph_detail" height="230" src="http://www.linuxexpres.cz/uploads/gallery/detail/6460.jpg" width="446" /></a> <span class="ph_title">Pohled na obsah schránky v Roundcube</span></p>
<p class="ph_center"><a href="http://www.linuxexpres.cz/uploads/gallery/original/6461.jpg" onclick="myPopImage('http://www.linuxexpres.cz/uploads/gallery/original/6461.jpg','Psaní pošty v Roundcube','1503','776'); return false;"><img alt="Psaní pošty v Roundcube" class="ph_detail" height="230" src="http://www.linuxexpres.cz/uploads/gallery/detail/6461.jpg" width="446" /></a> <span class="ph_title">Psaní pošty v Roundcube</span></p>
<p>Nemáte-li dosud nainstalovaný databázový server a nechcete-li používat SQLite, můžete nainstalovat třeba MySQL:</p>
<pre>aptitude install mysql-client mysql-server</pre>
<p>V takovém případě nezapomeňte nainstalovat také PHP knihovnu, která tvoří most mezi PHP aplikacemi a databází MySQL (<code>php5-mysql</code>), a také MySQL knihovnu, kterou používá samotný Roundcube (<code>roundcube-mysql</code>):</p>
<pre>aptitude install php5-mysql roundcube-mysql</pre>
<p>Máte-li nainstalováno všechno potřebné, co se týče databáze, samotnou instalaci Roundcube provedete stejně jako v případě Squirrelmailu:</p>
<pre>aptitude install roundcube</pre>
<p>Během instalace budete provedeni vytvořením databáze pro Roundcube. Pokud byste cokoliv opomněli, můžete konfiguraci provést kdykoliv znovu, a to pomocí příkazu:</p>
<pre>dpkg-reconfigure roundcube-core</pre>
<p>Nyní je třeba provést základní nastavení. Jako první je třeba vyřešit propojení s webovým serverem, které je v případě Roundcube automatické (resp. je vytvořen symbolický link v <code>/etc/apache2/conf.d</code> odkazující na <code>/etc/roundcube/apache.conf</code>. Tento odkaz buď vymažte a obsah tohoto souboru asimilujte do svého nastavení Apache, nebo tento soubor upravte a odkomentujte dva řádky s definicí aliasů:</p>
<pre>Alias /roundcube/program/js/tiny_mce/ /usr/share/tinymce/www/
Alias /roundcube /var/lib/roundcube</pre>
<p>Následně upravte soubor <code>/etc/roundcube/main.inc.php</code>, ve kterém je třeba definovat povolené servery, ke kterým se instance Roundcube na vašem serveru bude smět připojovat. Chcete-li používat Roundcube pro poštu pouze na vašem serveru, tedy na localhostu, proveďte úpravu proměnné <code>$rcmail_config['default_host']</code> takto:</p>
<pre>$rcmail_config['default_host'] = 'localhost';</pre>
<p>Chcete-li umožnit uživatelům připojovat se i k jiným IMAP serverům z vašeho serveru, můžete využít následujícího vzoru:</p>
<pre>$rcmail_config['default_host'] = array('localhost', 'ssl://mail.example.org:993');</pre>
<p>Pokud tuto volbu ponecháte prázdnou (což je výchozí nastavení), uživatelé se budou moci hlásit k libovolnému serveru (což se dá považovat za bezpečnostní riziko). Poté zbývá už jen restart Apache:</p>
<pre>service apache2 restart</pre>

<pre id="links"></pre>
