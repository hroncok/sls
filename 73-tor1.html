<meta http-equiv="content-type" content="text/html;charset=utf-8" />


<h1>Správa linuxového serveru: Tor na serveru: Úvod</h1>

<p>Tor je anonymizační nástroj, který nabízí různé typy použití jak na desktopu, tak na serveru. V tomto dílu bude představen Tor jako takový, dále možnosti jeho nasazení na server a hlavně hrozby, se kterými se při jeho používání můžete setkat.</p>

<h3>Úvod</h3>
<p>Tor je, jak už bylo poznamenáno výše, anonymizační nástroj. Jeho název je zkratkou pro „The onion router“, tedy „cibulový“ router. Zjednodušeně, pracuje tak, že náhodně vybere několik uzlů z Tor sítě a vytvoří z nich „obvod“ (circuit), přes který posílá šifrovaně veškerou komunikaci. Každý z uzlů tuší pouze, ze kterého uzlu a na který další uzel data tečou. Nedokáží odhadnout původního odesílatele a ani příjemce. Díky šifrování také netuší, jaká data vlastně přepravují.</p>
<p>Způsob šifrování se inspiroval cibulí - jedná se o „vrstvené“ šifrování. Jednotlivé uzly vždy svým klíčem paket dešifrují a odešlou dalšímu uzlu, který proceduru opakuje. Konečným bodem komunikace je výstupní uzel (exit node), kde se paket dešifruje úplně (odloupne se poslední vrstva „cibule“) a odešle. Odpověď na něj se pak pošle sítí zpět. Obvod jako takový se samozřejmě čas od času mění, takže nová spojení pak chodí jinudy.</p>
<p>Tor má však jednu vlastnost navíc. Dokáže anonymizovat nejenom komunikaci směrem „ven“, tedy do internetu, ale také komunikaci směrem „dovnitř“. Server připojený k Tor síti může anonymizovat některou svou běžící službu a nabídnout ji členům Tor sítě. Tato „vnitřní“ síť se běžně nazývá „darknet“.</p>
<p>Na anonymizaci se nelze spoléhat 100%, což jednak osvětlí hrozby uvedené níže, a jednak to říká i samotný Tor, který při startu vypisuje hlášku:</p>
<pre>This is experimental software. Do not rely on it for strong anonymity.</pre>
<p>Tato hláška říká, že byste měli považovat Tor za experimentální software a nespoléhat na něj jako na poskytovatele silné anonymity. Jinými slovy, určitě je třeba zvážit, jakým způsobem a k čemu budete Tor využívat, stejně jako rizika z toho vyplývající.</p>
<p>Na závěr úvodu je třeba zmínit, že Tor není jediná služba podobného typu. Anonymizačních služeb a sítí existuje samozřejmě <a href="http://en.wikipedia.org/wiki/Category:Anonymity_networks">více</a>.</p>
<h3>Možnosti nasazení Toru na server</h3>
<p><a href="https://www.torproject.org/">Tor</a> je svobodný software napsaný v jazyce C a šířený pod BSD licencí. Je možné jej nasadit nejenom jako klienta, který vám umožní brouzdat po webu anonymně nebo objevovat temná zákoutí darknetu, ale je také možné jej nasadit i na server, a to hned čtyřmi způsoby.</p>
<p>První možností je vytvořit si <strong>Tor relay</strong>, tedy „zapojit“ váš server do sítě Tor, aby přes něj mohla téct data uživatelů a anonymita sítě jako takové mírně vzrostla. Zde máte dvě možnosti - buď vytvoříte pouze průchozí uzel, přes který budou data téct, ale který nebude sloužit jako výstupní uzel (<strong>exit relay</strong>), nebo vytvoříte uzel, který bude sloužit i jako výstupní.</p>
<p>Seznam Tor uzlů je veřejný - pokud se tedy připojíte k síti Tor (jako relay), zařadí se váš server automaticky do tohoto seznamu. To vyplývá ze samotného pricipu sítě - klient potřebuje v první řadě seznam uzlů, aby byl schopen vytvořit obvod. Pokud se vám toto nezamlouvá, stále můžete vytvořit „tichý“ uzel (<strong>bridge relay</strong>), který se nikde zveřejňovat nebude. Díky tichým uzlům pak může Tor využívat i uživatel připojený přes ISP, který Tor jako takový blokuje.</p>
<p>Poslední variantou je možnost anonymizovat některou službu, která běží na vašem serveru (webový server, apod.), a vytvořit tzv. <strong>hidden service</strong> (skrytou službu). Klienti Tor sítě pak k této službě budou moci přistupovat, aniž by tušili, kde se server nachází, nebo aniž by váš server měl šanci zjistit, kým je vlastně využíván. Pro tuto možnost využití Toru nepotřebujete, aby váš server pracoval jako relay.</p>
<h3>Hrozby spojené s Torem</h3>
<p>Jelikož Tor je jeden z nejpoužívanějších anonymizačních nástrojů, čelí celé řadě hrozeb. Ačkoliv se uživatelské stránce věci nechci příliš věnovat vzhledem k povaze seriálu, přesto si dovolím hlavní body hrozeb použití Toru rozebrat, a to včetně hrozeb z pohledu uživatele (některé z nich jsou relevantní i pro správce serverů, zejména pak správce nějaké „skryté služby“).</p>
<h4>Hrozby z pohledu uživatele</h4>
<p>Zásadní problémy Toru jsou dvě věci. Tou první je fakt, že Tor neřeší anonymitu samotných aplikací. To znamená, že Tor může fungovat bezchybně, ale aplikace (např. webový prohlížeč) ochotně prozradí vaši skutečnou IP adresu (za tímto účelem lze v případě webového prohlížeče použít skriptovací jazyky a „rozšiřující“ technologie jako Java, JavaScript, Flash, apod.). Může také docházet k „prosakování“ citlivých informací jako např. názvy navštívených webů, které bude špatně nastavená (nebo špatně napsaná) aplikace získávat z místního DNS resolveru, který se bude nejspíše ptát DNS serverů vašeho poskytovatele.</p>
<p>Druhým zásadním problémem je vztah anonymity a bezpečnosti. Tor řeší anonymitu (v rámci možností), ale neřeší bezpečnost. Používání Toru vás jednoznačně vystavuje hrozbám spojeným s výstupními uzly. Ty totiž mají kontrolu nad vaší komunikací. Mohou vás šmírovat, zaznamenávat všechna hesla posílaná v plain textu (což se v minulosti dělo a může se kdykoliv dít znovu) a mohou realizovat všemožné MITM (man-in-the-middle) útoky.</p>
<p>Očividnou hrozbou je pak samotné chování uživatele, jako např. podepsání příspěvku nebo specifický styl psaní, který je možné porovnat s dřívějšími příspěvky, a dopátrat se vaší IP adresy z doby, kdy jste daný web navštěvovali bez použití Toru.</p>
<p>Trošku pokročilejší hrozbou je pak korelační analýza, která může na základě časových a jiných údajů identifikovat uživatele, má-li útočník pod kontrolou vstupní a výstupní uzel (nebo přístup k datům, která k nim tečou).</p>
<p>Samotné prohlížeče dnes představují velký problém, jelikož o sobě prozrazují příliš mnoho informací. Unikátní nebo méně obvyklé nastavení prohlížeče vás může identifikovat nebo vaší identifikaci napomoci. Jedná se o tzv. „<a href="http://panopticlick.eff.org/">browser fingerprinting</a>“. Z tohoto důvodu se tedy často nedoporučuje používat stejný prohlížeč pro normální brouzdání webem a pro brouzdání prostřednictvím Toru.</p>
<p>Řada webů dnes využívá komponenty od Googlu či od Facebooku, čímž těmto společnostem dává možnost analyzovat pohyb uživatelů po webu. Navštěvujete-li tedy stejné stránky stejným způsobem (nebo hůř - se stejným prohlížečem) bez ohledu na použití Toru, je možné, že některá z těchto firem si vaši identitu propojí.</p>
<h4>Hrozby z pohledu správce serveru</h4>
<p>Osobně vidím z pohledu správce dva problémy při použití Toru. První je možnost zařazení Tor uzlu do nejrůznějších blacklistů. To může být způsobeno jednak tím, co se přes váš server posílá (máte-li uzel s povoleným výstupem), a jednak jistým „proaktivním“ přístupem některých subjektů, které plošně blokují nebo zařazují do blacklistů IP adresy Tor uzlů bez ohledu na to, jestli se dané počítače něčeho skutečně dopustí nebo nikoliv.</p>
<p>Nebývá neobvyklé, že se zakáže uživatelům přístup nebo možnost přispívání, pokud přicházejí ze sítě Tor. Horší je to pak s blacklisty, které jsou používány na úrovni zpracování pošty pro boj se spamem. Pokud tedy na stejné IP adrese provozujete poštovní server, můžete se na nějaký z blacklistů dostat a mít pak problém s doručováním pošty.</p>
<p>Druhým možným problémem může být reakce policie na nějaký incident, který zapříčinil uživatel Toru prostřednictvím vašeho serveru (týká se samozřejmě výstupních uzlů). Nejedná se pouze o to, že se můžete stát předmětem vyšetřování (jelikož je to váš server), ale také o to, co se stane s příslušným serverem a oblastí jeho uložení. Stále mám v živé paměti zátah, při kterém slovenští policisté zabavili 10 serverů jisté webhostingové společnosti, a úspěšně tak „odpojili“ 3500 webů (souvislost s Torem to nemělo, ale problém to jistě ilustruje). Určitě si tedy rozmyslete, kde budete případný výstupní uzel provozovat, aby případný zátah a konfiskace serveru nevyřadila důležité služby. Stejně tak důrazně doporučuji informovat dotčeného poskytovatele (serverhousingu, VPS, zaměstnavatele, apod.).</p>
<p>Jelikož řada poskytovatelů (serverhousingu, VPS, apod.) dnes vydává podmínky, ve kterých činí zákazníky odpovědné za škody, které vzniknou v souvislosti s jimi používanou službou (bez ohledu na to, zda-li ji způsobil klient, útočník nebo někdo úplně jiný), doporučuji si znovu pročíst příslušné podmínky a rozmyslet se, popřípadě to s příslušným subjektem probrat i v této rovině.</p>
<h3>Závěr</h3>
<p>Tor je nástrojem, který poskytuje uživatelům jistou míru anonymity, stejně jako možnost obejít vládní či korporátní cenzuru internetu. Podobně jako jakýkoliv jiný nástroj je možné Tor využít jak k etickému konání, tak k neetickému (potažmo také k nezákonnému).</p>
<p>Jak už jsem zmínil v úvodu, způsob použití Toru je třeba zvážit. Zde zmíněný výčet hrozeb jistě není úplný, ať už proto, že jsem na něco zapomněl já, nebo tím, že ne všechny hrozby byly dosud objeveny.</p>
<p>Tím bych tento úvodní díl ukončil. V příštím díle vám Tor představím z technického hlediska.</p>

<pre id="links"></pre>
