<meta http-equiv="content-type" content="text/html;charset=utf-8" />


<h1>Správa linuxového serveru: Instalace LAMP</h1>

<p>LAMP je zkratkou pro Linux, Apache, MySQL a PHP. Tento díl seriálu se bude zabývat základním zprovozněním Apache, MySQL a PHP v distribuci Debian. Nainstalována bude i webová aplikace phpMyAdmin sloužící k pohodlné správě databáze.</p>

<h3>Úvod</h3>
<p>Na úvod je třeba zdůraznit, že pro jednotlivé komponenty ze zkratky LAMP existují alternativy, které mohou být v mnoha situacích příhodnější. Už samotný webový server Apache má v prostředí GNU/Linuxu poměrně velkou konkurenci. Existují odlehčené varianty snažící se o vyšší výkon jako např. <a href="http://www.lighttpd.net/">Lighttpd</a>, na kterém běží tak gigantické projekty jako Youtube, Wikipedia atd., ale také třeba <a href="http://nginx.org/">Nginx</a>. Zajímavým projektem hodným zmínky je i webový server <a href="http://www.cherokee-project.com/">Cherokee</a>, který poskytuje přehledné webové konfigurační rozhraní, čímž odstraňuje nutnost editovat konfigurační soubory ručně, a ještě k tomu je nenáročný na zdroje a nabízí také <a href="http://c6s.co.uk/webdev/209">velmi slušný výkon</a>.</p>
<p>Pokud se posunete k dalšímu písmenku, tedy k databázovému systému MySQL, i zde je v prostředí GNU/Linuxu značná konkurence. Na mysl by vám zde určitě měl přijít <a href="http://www.postgres.cz/">PostgreSQL</a>, <a href="http://www.firebirdsql.org/">Firebird</a> a další. Pokud vás zajímají rozdíly jednotlivých databázových systémů, můžete si přečíst článek <a href="http://www.linuxexpres.cz/software/srovnani-databazovych-serveru">Srovnání databázových serverů</a>, nebo se podívat na <a href="http://en.wikipedia.org/wiki/Comparison_of_relational_database_management_systems">komplexní srovnání</a> databázových systémů na Wikipedii.</p>
<p>Posledním písmenkem ve zkratce LAMP je písmeno P, značící PHP. Ačkoliv se jedná o jeden z nejpoužívanějších jazyků pro tvorbu webových aplikací, má svoje nedostatky (i když řadu z nich se snaží řešit řada PHP frameworků) a existuje opět řada alternativ, z nichž budu jmenovat alespoň Javu, Python či Ruby.</p>
<h4>Instalace Apache</h4>
<p>Samotná instalace Apache je v Debianu, ale i v řadě jiných distribucí velmi triviální – postačí nainstalovat jediný balíček – v případě Debianu balíček <code>apache2</code>:</p>
<pre>aptitude install apache2</pre>
<p>Po instalaci dojde ke spuštění serveru a vy se můžete na web rovnou podívat (postačí do prohlížeče zadat IP adresu serveru). Měl by se objevit známý nápis „<em>It works!“</em> značící, že je všechno v pořádku a webový server běží. Pokud pracujete vzdáleně přes SSH a máte k dispozici některý z konzolových webových prohlížečů (např. <code>lynx</code>), můžete webový server otestovat lokálně tímto způsobem:</p>
<pre>lynx localhost</pre>
<p>Apache očekává webovou prezentaci v adresáři <code>/var/www</code>, a to je také umístění, ze kterého v tomto případě zobrazil obsah souboru <code>index.html</code>.</p>
<h4>Instalace PHP</h4>
<p>Pokud se jedná o základní instalaci PHP, ani zde není příliš velký problém – je ovšem potřeba nějakým způsobem PHP s Apachem propojit. O to se postará balíček <code>libapache2-mod-php5</code>:</p>
<pre>aptitude install libapache2-mod-php5 php5</pre>
<p>Po provedení tohoto příkazu restartujte Apache:</p>
<pre>/etc/init.d/apache2 restart</pre>
<p>V tuto chvíli by bylo dobré otestovat, zda vše korektně funguje a PHP aplikace vám poběží. Proto vytvořte soubor <code>/var/www/index.php</code> s následujícím obsahem:</p>
<pre>&lt;?php phpinfo(); ?&gt;</pre>
<p>Jelikož HTML soubory dostanou před PHP soubory přednost, můžete buď <code>index.html</code> ve <code>/var/www</code> vymazat, nebo zadat do prohlížeče explicitně cestu k <code>index.php</code>. Poté byste měli vidět uvítací stránku PHP detailně popisující konfiguraci. Pokud máte na serveru k dispozici Lynx, můžete se přesvědčit pomocí něj:</p>
<pre>lynx localhost/index.php</pre>
<p>Pokud dostanete místo popisu konfigurace PHP obsah souboru <code>index.php</code> v textové podobě, máte problém s konfigurací. Buď jste nerestartovali Apache, nebo jste nenainstalovali balíček <code>libapache2-mod-php5</code>.</p>
<p>Proběhlo-li vše v pořádku, máte k dispozici webový server schopný běhu PHP aplikací. PHP je ovšem modulární, takže v tuto chvíli máte k dispozici pouze základní PHP bez řady doplňků, které webové aplikace často využívají. Bývá dobrou praxí instalovat pouze ty doplňky, které opravdu potřebujete. Podívejte se tedy do dokumentace aplikací, které chcete na serveru provozovat, a nainstalujte doplňky pro PHP dle toho. Seznam doplňků, které jsou dostupné v Debianu, získáte kupříkladu takto:</p>
<pre>aptitude search php5</pre>
<h4>Instalace MySQL</h4>
<p>Instalace MySQL obnáší nutnost nainstalovat PHP modul, který je schopný s MySQL pracovat, konkrétně <code>php5-mysql</code>. Samotnou instalaci MySQL serveru, klienta a modulu pro PHP zajistíte následujícím příkazem:</p>
<pre>aptitude install php5-mysql mysql-server</pre>
<p>Během instalace budete požádáni o zadání hesla pro administrátorský účet databáze. Důrazně se doporučuje této možnosti využít a administrátorský účet heslem ochránit. To platí dvojnásob v situaci, kdy zpřístupníte rozhraní databáze přes webové stránky veřejnosti, pomocí aplikace <code>phpmyadmin</code>.</p>
<p>Pokud využíváte řádkového klienta MySQL a vadí vám nutnost zadávat heslo, můžete si pomoci vytvořením využít konfigurační soubor MySQL klienta <code>$HOME/.my.cnf</code>, kam můžete heslo uvést, aby se vás na něj řádkový MySQL klient nemusel ptát. Obsah daného souboru upravte podle následujícího vzoru:</p>
<pre>[client]
password=heslo</pre>
<h4>Instalace aplikace phpMyAdmin</h4>
<p>PhpMyAdmin je webová aplikace napsaná v PHP a určená k pohodlné správě MySQL databáze. Představuje možnost, jak pracovat s databázovým systémem rychle, přehledně a efektivně bez nutnosti psát všechny SQL příkazy ručně. V případě LAMP serverů je této aplikace hojně využíváno také kvůli možnosti snadného importu a exportu dat z nebo do databáze. Více informací o použití této aplikace naleznete v článku <a href="http://www.linuxexpres.cz/praxe/sprava-databazi-pomoci-phpmyadmin">Správa databází pomocí phpMyAdmin</a>. Instalaci nástroje phpMyAdmin provedete v Debianu takto:</p>
<pre>aptitude install phpmyadmin</pre>
<p>V průběhu instalace se vás instalátor dotáže, zdali má zkonfigurovat některé servery pro běh phpmyadmina – zde zvolte <code>apache2</code>. Díky tomu budete moci po instalaci začít aplikaci phpMyAdmin rovnou používat – bude dostupná v umístění <code>/phpmyadmin</code> relativně ke kořenu serveru:</p>
<pre>lynx localhost/phpmyadmin</pre>
<p>Budete-li k této aplikaci přistupovat vzdáleně, čiňte tak raději přes HTTPS, až tímto způsobem webový server nastavíte. Budete-li používat nešifrovaný protokol HTTP, umožníte kterémukoliv naslouchajícímu na cestě mezi vámi a vaším serverem, aby vaše heslo k databázi odposlechl.</p>
<h4>LAMP je (skoro) hotov</h4>
<p>V tuto chvíli již máte nainstalován funkční webový server s databází MySQL a podporou pro PHP aplikace. Můžete si vyzkoušet práci s databází prostřednictvím phpMyAdmina, popřípadě si na server zkusit nahrát nějakou PHP aplikaci a zkusit ji zprovoznit. Jistě jste si všimli, že nebylo třeba zasahovat do konfiguračních souborů – bylo využito výchozí konfigurace Debianu. Bohužel tato výchozí konfigurace má své nedostatky. Předně PHP je nastaveno v režimu navrženém pro vývojové, nikoliv pro produkční servery (nevyužívá tedy adekvátní možnosti zabezpečení pro produkční servery). Dále Apache v tuto chvíli nabízí jedinou prezentaci ve <code>/var/www</code> pro všechny domény, které jsou na webový server nasměrované. Není také nakonfigurované SSL, takže není přístupná varianta webu přes zabezpečený protokol HTTPS. Konfiguraci a možnostem zabezpečení se budou věnovat další díly.</p>

<pre id="links">http://www.linuxexpres.cz/praxe/konfigurace-a-optimalizace-apache Konfigurace a optimalizace Apache
http://www.howtoforge.com/ubuntu_debian_lamp_server How To Set Up A Ubuntu/Debian LAMP Server
http://www.debian-administration.org/articles/138 Tightening PHP security</pre>
